        -:    0:Source:../hvm4/clang/heap/take.c
        -:    0:Graph:hvm4-cov-main.gcno
        -:    0:Data:hvm4-cov-main.gcda
        -:    0:Runs:22
       70:    1:fn Term heap_take(u32 loc) {
       70:    2:  if (__builtin_expect(THREAD_COUNT == 1, 1)) {
       70:    3:    Term term = HEAP[loc];
       70:    4:    if (__builtin_expect(term != 0, 1)) {
       70:    5:      return term;
        -:    6:    }
    #####:    7:    fprintf(stderr, "ERROR: heap_take saw zero at %u in single-threaded mode\n", loc);
    #####:    8:    abort();
        -:    9:  }
    #####:   10:  for (;;) {
    #####:   11:    Term prev = __atomic_exchange_n(&HEAP[loc], 0, __ATOMIC_RELAXED);
    #####:   12:    if (__builtin_expect(prev != 0, 1)) {
    #####:   13:      return prev;
        -:   14:    }
    #####:   15:    cpu_relax();
        -:   16:  }
        -:   17:}
