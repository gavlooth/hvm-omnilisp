        -:    0:Source:../hvm4/clang/heap/init_slices.c
        -:    0:Graph:hvm4-cov-main.gcno
        -:    0:Data:hvm4-cov-main.gcda
        -:    0:Runs:22
       22:    1:fn void heap_init_slices(void) {
       22:    2:  u32 threads = thread_get_count();
       22:    3:  if (threads == 0) {
    #####:    4:    threads = 1;
        -:    5:  }
       22:    6:  if (threads > MAX_THREADS) {
    #####:    7:    threads = MAX_THREADS;
        -:    8:  }
        -:    9:
       22:   10:  u64 words = HEAP_CAP;
       22:   11:  u64 bank_sz = words / threads;
       22:   12:  u64 at = 0;
        -:   13:
       44:   14:  for (u32 t = 0; t < threads; t++) {
       22:   15:    u64 start = at;
      22*:   16:    u64 end = (t == threads - 1) ? words : (at + bank_sz);
       22:   17:    if (t == 0 && start == 0) {
       22:   18:      start = 1;
        -:   19:    }
       22:   20:    HEAP_NEXT_AT(t) = start;
       22:   21:    HEAP_END_AT(t) = end;
       22:   22:    at += bank_sz;
        -:   23:  }
        -:   24:
     1408:   25:  for (u32 t = threads; t < MAX_THREADS; t++) {
     1386:   26:    HEAP_NEXT_AT(t) = 0;
     1386:   27:    HEAP_END_AT(t) = 0;
        -:   28:  }
       22:   29:}
