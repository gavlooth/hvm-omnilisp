        -:    0:Source:../hvm4/clang/heap/init_slices.c
        -:    0:Graph:main-cov-main.gcno
        -:    0:Data:main-cov-main.gcda
        -:    0:Runs:422
      417:    1:fn void heap_init_slices(void) {
      417:    2:  u32 threads = thread_get_count();
      417:    3:  if (threads == 0) {
    #####:    4:    threads = 1;
        -:    5:  }
      417:    6:  if (threads > MAX_THREADS) {
    #####:    7:    threads = MAX_THREADS;
        -:    8:  }
        -:    9:
      417:   10:  u64 words = HEAP_CAP;
      417:   11:  u64 bank_sz = words / threads;
      417:   12:  u64 at = 0;
        -:   13:
      834:   14:  for (u32 t = 0; t < threads; t++) {
      417:   15:    u64 start = at;
     417*:   16:    u64 end = (t == threads - 1) ? words : (at + bank_sz);
      417:   17:    if (t == 0 && start == 0) {
      417:   18:      start = 1;
        -:   19:    }
      417:   20:    HEAP_NEXT_AT(t) = start;
      417:   21:    HEAP_END_AT(t) = end;
      417:   22:    at += bank_sz;
        -:   23:  }
        -:   24:
    26688:   25:  for (u32 t = threads; t < MAX_THREADS; t++) {
    26271:   26:    HEAP_NEXT_AT(t) = 0;
    26271:   27:    HEAP_END_AT(t) = 0;
        -:   28:  }
      417:   29:}
