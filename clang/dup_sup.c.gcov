        -:    0:Source:../hvm4/clang/wnf/dup_sup.c
        -:    0:Graph:main-cov-main.gcno
        -:    0:Data:main-cov-main.gcda
        -:    0:Runs:9
        -:    1:// ! X &L = &R{a,b}
        -:    2:// ---------------- DUP-SUP
        -:    3:// if L == R:
        -:    4://   X₀ ← a
        -:    5://   X₁ ← b
        -:    6:// else:
        -:    7://   ! A &L = a
        -:    8://   ! B &L = b
        -:    9://   X₀ ← &R{A₀,B₀}
        -:   10://   X₁ ← &R{A₁,B₁}
    #####:   11:fn Term wnf_dup_sup(u32 lab, u32 loc, u8 side, Term sup) {
    #####:   12:  ITRS++;
    #####:   13:  u32 sup_loc = term_val(sup);
    #####:   14:  u32 sup_lab = term_ext(sup);
    #####:   15:  if (lab == sup_lab) {
    #####:   16:    Term tm0 = heap_read(sup_loc + 0);
    #####:   17:    Term tm1 = heap_read(sup_loc + 1);
    #####:   18:    return heap_subst_cop(side, loc, tm0, tm1);
        -:   19:  } else {
    #####:   20:    u64 base = heap_alloc(6);
    #####:   21:    u32 at   = (u32)base;
    #####:   22:    heap_write(at + 0, heap_read(sup_loc + 0));
    #####:   23:    heap_write(at + 1, heap_read(sup_loc + 1));
    #####:   24:    Copy A  = term_clone_at(at + 0, lab);
    #####:   25:    Copy B  = term_clone_at(at + 1, lab);
    #####:   26:    Term s0 = term_new_sup_at(at + 2, sup_lab, A.k0, B.k0);
    #####:   27:    Term s1 = term_new_sup_at(at + 4, sup_lab, A.k1, B.k1);
    #####:   28:    return heap_subst_cop(side, loc, s0, s1);
        -:   29:  }
        -:   30:}
