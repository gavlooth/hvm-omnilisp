;; test_str_concat.lisp - Tests for string concatenation

;; Str concatenates multiple values into a string
;; TEST: str with two strings
;; EXPECT: "helloworld"
(str-concat "hello" "world")

;; TEST: str with space
;; EXPECT: "hello world"
(str-concat "hello" " " "world")

;; TEST: str empty strings
;; EXPECT: ""
(str-concat "" "")

;; TEST: str single string
;; EXPECT: "hello"
(str-concat "hello")

;; TEST: str multiple parts
;; EXPECT: "abcdef"
(str-concat "a" "b" "c" "d" "e" "f")

;; TEST: str with numbers (as strings)
;; EXPECT: "123"
(str-concat "1" "2" "3")

;; Join with separator
(define str-join [sep] [strs]
  (match strs
    ()       ""
    (s)      s
    (h .. t) (str-concat h sep (str-join sep t))))

;; TEST: join with comma
;; EXPECT: "a,b,c"
(str-join "," '("a" "b" "c"))

;; TEST: join with space
;; EXPECT: "hello world today"
(str-join " " '("hello" "world" "today"))

;; TEST: join single
;; EXPECT: "only"
(str-join "," '("only"))

;; TEST: join empty
;; EXPECT: ""
(str-join "," '())

;; TEST: join with longer separator
;; EXPECT: "a--b--c"
(str-join "--" '("a" "b" "c"))
