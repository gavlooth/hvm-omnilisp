;; test_set_intersection.lisp - Tests for set intersection

;; Set intersection returns elements in both sets
(define set-intersection-helper [s1] [keys] [result]
  (match keys
    ()       result
    (k .. rest)
      (if (dict-has? s1 k)
        (set-intersection-helper s1 rest (dict-set result k true))
        (set-intersection-helper s1 rest result))))

(define set-intersection [s1] [s2]
  (set-intersection-helper s1 (dict-keys s2) #{}))

;; TEST: intersection with overlap
;; EXPECT: #{2 true 3 true}
(set-intersection #{1 2 3} #{2 3 4})

;; TEST: intersection disjoint sets
;; EXPECT: #{}
(set-intersection #{1 2} #{3 4})

;; TEST: intersection with empty set (left)
;; EXPECT: #{}
(set-intersection #{} #{1 2})

;; TEST: intersection with empty set (right)
;; EXPECT: #{}
(set-intersection #{1 2} #{})

;; TEST: intersection is idempotent with self
;; EXPECT: #{1 true 2 true 3 true}
(set-intersection #{1 2 3} #{1 2 3})

;; TEST: intersection subset
;; EXPECT: #{2 true}
(set-intersection #{1 2 3 4 5} #{2})

;; TEST: intersection with symbols
;; EXPECT: #{:b true :c true}
(set-intersection #{:a :b :c} #{:b :c :d})
