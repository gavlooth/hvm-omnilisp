;; test_json_stringify.lisp - Tests for JSON stringification

;; Json-stringify converts value to JSON string
;; TEST: stringify null
;; EXPECT: "null"
(json-stringify nil)

;; TEST: stringify true
;; EXPECT: "true"
(json-stringify true)

;; TEST: stringify false
;; EXPECT: "false"
(json-stringify false)

;; TEST: stringify integer
;; EXPECT: "42"
(json-stringify 42)

;; TEST: stringify negative
;; EXPECT: "-123"
(json-stringify -123)

;; TEST: stringify float
;; EXPECT: "3.14"
(json-stringify 3.14)

;; TEST: stringify string
;; EXPECT: "\"hello\""
(json-stringify "hello")

;; TEST: stringify string with quotes
;; EXPECT: "\"hello\\\"world\""
(json-stringify "hello\"world")

;; TEST: stringify array
;; EXPECT: "[1,2,3]"
(json-stringify [1 2 3])

;; TEST: stringify list as array
;; EXPECT: "[1,2,3]"
(json-stringify '(1 2 3))

;; TEST: stringify empty array
;; EXPECT: "[]"
(json-stringify [])

;; TEST: stringify dict as object
;; EXPECT: "{\"a\":1,\"b\":2}"
(json-stringify #{"a" 1 "b" 2})

;; TEST: stringify empty object
;; EXPECT: "{}"
(json-stringify #{})

;; TEST: stringify nested
;; EXPECT: "{\"items\":[1,2,3]}"
(json-stringify #{"items" [1 2 3]})

;; Pretty printing
;; TEST: pretty print
;; EXPECT: "{\n  \"a\": 1\n}"
(json-stringify-pretty #{"a" 1})

;; Roundtrip
;; TEST: roundtrip
;; EXPECT: #{"name" "test" "value" 42}
(json-parse (json-stringify #{"name" "test" "value" 42}))
