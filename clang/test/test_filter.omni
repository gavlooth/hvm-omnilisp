;; test_filter.lisp - Tests for filter

;; Filter keeps elements matching predicate
(define filter [pred] [lst]
  (match lst
    ()       '()
    (h .. t) (if (pred h)
               (cons h (filter pred t))
               (filter pred t))))

;; TEST: filter evens
;; EXPECT: (2 4 6 8 10)
(filter (lambda [x] (= (% x 2) 0)) '(1 2 3 4 5 6 7 8 9 10))

;; TEST: filter odds
;; EXPECT: (1 3 5 7 9)
(filter (lambda [x] (!= (% x 2) 0)) '(1 2 3 4 5 6 7 8 9 10))

;; TEST: filter positive
;; EXPECT: (1 2 3)
(filter (lambda [x] (> x 0)) '(-2 -1 0 1 2 3))

;; TEST: filter all match
;; EXPECT: (1 2 3 4 5)
(filter (lambda [x] (> x 0)) '(1 2 3 4 5))

;; TEST: filter none match
;; EXPECT: ()
(filter (lambda [x] (< x 0)) '(1 2 3 4 5))

;; TEST: filter empty list
;; EXPECT: ()
(filter (lambda [x] true) '())

;; Combine filter with other operations
;; TEST: sum of filtered evens
(define sum [lst]
  (match lst
    ()       0
    (h .. t) (+ h (sum t))))

;; EXPECT: 30
(sum (filter (lambda [x] (= (% x 2) 0)) '(1 2 3 4 5 6 7 8 9 10)))
