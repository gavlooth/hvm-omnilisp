;; test_str_repeat.lisp - Tests for string repetition

;; Str-repeat repeats a string n times
;; TEST: repeat 3 times
;; EXPECT: "abcabcabc"
(str-repeat "abc" 3)

;; TEST: repeat once
;; EXPECT: "hello"
(str-repeat "hello" 1)

;; TEST: repeat zero times
;; EXPECT: ""
(str-repeat "hello" 0)

;; TEST: repeat single char
;; EXPECT: "xxxxx"
(str-repeat "x" 5)

;; TEST: repeat empty string
;; EXPECT: ""
(str-repeat "" 10)

;; TEST: repeat space
;; EXPECT: "   "
(str-repeat " " 3)

;; Padding helpers using repeat
(define str-pad-left [s] [len] [pad]
  (let [current (str-len s)]
    (if (>= current len)
      s
      (str-concat (str-repeat pad (- len current)) s))))

(define str-pad-right [s] [len] [pad]
  (let [current (str-len s)]
    (if (>= current len)
      s
      (str-concat s (str-repeat pad (- len current))))))

;; TEST: pad-left
;; EXPECT: "00042"
(str-pad-left "42" 5 "0")

;; TEST: pad-left already long enough
;; EXPECT: "hello"
(str-pad-left "hello" 3 "x")

;; TEST: pad-right
;; EXPECT: "hi..."
(str-pad-right "hi" 5 ".")

;; TEST: pad-right already long enough
;; EXPECT: "hello"
(str-pad-right "hello" 3 "x")
