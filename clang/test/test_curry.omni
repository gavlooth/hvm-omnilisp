;; test_curry.omni - Tests for curry function combinator

;; TEST: curry binary function
;; EXPECT: 15
(do (define add [x] [y] (+ x y))
    ((curry add) 5 10))

;; TEST: curried partial application
;; EXPECT: 12
(do (define add [x] [y] (+ x y))
    (let [add5 ((curry add) 5)]
      (add5 7)))

;; TEST: curry with explicit arity
;; EXPECT: 6
(do (define add3 [x] [y] [z] (+ x (+ y z)))
    ((curry add3 3) 1 2 3))

;; TEST: curry nested application
;; EXPECT: 20
(do (define add [x] [y] (+ x y))
    (let [addCurried (curry add)]
      (let [add8 (addCurried 8)]
        (add8 12))))

;; TEST: curry subtract
;; EXPECT: 7
(do (define sub [x] [y] (- x y))
    ((curry sub) 10 3))

;; TEST: curry with partial then complete
;; EXPECT: 2
(do (define sub [x] [y] (- x y))
    (let [sub10 ((curry sub) 10)]
      (sub10 8)))

;; TEST: curry with multiply (using defined function)
;; EXPECT: 100
(do (define mul [x] [y] (* x y))
    (let [mul10 ((curry mul) 10)]
      (mul10 10)))
