;; test_type_pred_fn.lisp - Tests for function predicates

;; TEST: fn? with lambda
;; EXPECT: true
(fn? (lambda [x] x))

;; TEST: fn? with named function
;; EXPECT: true
(let [f (lambda [x] (+ x 1))]
  (fn? f))

;; TEST: fn? with int
;; EXPECT: false
(fn? 42)

;; TEST: fn? with string
;; EXPECT: false
(fn? "function")

;; TEST: fn? with nil
;; EXPECT: false
(fn? nil)

;; Callable? is alias
(define callable? [x] (fn? x))

;; TEST: callable? lambda
;; EXPECT: true
(callable? (lambda [x] x))

;; TEST: callable? value
;; EXPECT: false
(callable? 42)

;; Procedure? same as fn?
(define procedure? [x] (fn? x))

;; TEST: procedure?
;; EXPECT: true
(procedure? (lambda [] "hello"))

;; Apply only if callable
(define apply-if-fn [x] [arg]
  (if (fn? x) (x arg) x))

;; TEST: apply-if-fn with fn
;; EXPECT: 10
(apply-if-fn (lambda [x] (* x 2)) 5)

;; TEST: apply-if-fn with value
;; EXPECT: 42
(apply-if-fn 42 5)

;; Higher order check
(define map-if-fn [f] [lst]
  (if (fn? f)
    (map f lst)
    lst))

;; TEST: map-if-fn with function
;; EXPECT: (2 4 6)
(map-if-fn (lambda [x] (* x 2)) '(1 2 3))

;; TEST: map-if-fn with non-function
;; EXPECT: (1 2 3)
(map-if-fn 42 '(1 2 3))
