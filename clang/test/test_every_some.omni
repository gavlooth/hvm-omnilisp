;; test_every_some.lisp - Tests for every?, some?, none?

;; Every? - all elements match predicate
(define every? [pred] [lst]
  (match lst
    ()       true
    (h .. t) (if (pred h) (every? pred t) false)))

;; TEST: every positive
;; EXPECT: true
(every? (lambda [x] (> x 0)) '(1 2 3 4 5))

;; TEST: every fails one
;; EXPECT: false
(every? (lambda [x] (> x 0)) '(1 2 0 4 5))

;; TEST: every on empty is true
;; EXPECT: true
(every? (lambda [x] (> x 100)) '())

;; Some? - at least one element matches
(define some? [pred] [lst]
  (match lst
    ()       false
    (h .. t) (if (pred h) true (some? pred t))))

;; TEST: some finds match
;; EXPECT: true
(some? (lambda [x] (= x 3)) '(1 2 3 4 5))

;; TEST: some finds no match
;; EXPECT: false
(some? (lambda [x] (= x 10)) '(1 2 3 4 5))

;; TEST: some on empty is false
;; EXPECT: false
(some? (lambda [x] true) '())

;; None? - no elements match
(define none? [pred] [lst]
  (not (some? pred lst)))

;; TEST: none when all fail predicate
;; EXPECT: true
(none? (lambda [x] (< x 0)) '(1 2 3 4 5))

;; TEST: none when one matches
;; EXPECT: false
(none? (lambda [x] (= x 3)) '(1 2 3 4 5))

;; TEST: none on empty is true
;; EXPECT: true
(none? (lambda [x] true) '())
