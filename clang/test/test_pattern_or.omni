;; test_pattern_or.lisp - Tests for or-patterns

;; Or-patterns match any of multiple patterns
;; TEST: basic or-pattern
;; EXPECT: :small
(match 1
  (| 0 1 2)  :small
  _          :other)

;; TEST: or-pattern second match
;; EXPECT: :small
(match 2
  (| 0 1 2)  :small
  _          :other)

;; TEST: or-pattern no match
;; EXPECT: :other
(match 5
  (| 0 1 2)  :small
  _          :other)

;; TEST: or with symbols
;; EXPECT: :fruit
(match 'apple
  (| 'apple 'banana 'orange)  :fruit
  _                           :other)

;; TEST: or in nested pattern
;; EXPECT: :found
(match '(1 2)
  ((| 1 2) (| 2 3))  :found
  _                  :not-found)

;; TEST: or with binding (shares name)
;; EXPECT: 5
(match 5
  (| 0 x)  x
  _        -1)

;; TEST: or multiple clauses
;; EXPECT: :number
(match 42
  (| 0 1)       :binary
  (| x & int?)  :number
  _             :other)

;; TEST: or in list pattern
;; EXPECT: :starts-small
(match '(1 2 3)
  ((| 0 1 2) .. rest)  :starts-small
  _                    :other)

;; TEST: or with nil
;; EXPECT: :empty
(match nil
  (| nil ())  :empty
  _           :full)

;; TEST: or-pattern with strings
;; EXPECT: :yes
(match "yes"
  (| "yes" "y" "Y" "YES")  :yes
  (| "no" "n" "N" "NO")    :no
  _                        :unknown)
